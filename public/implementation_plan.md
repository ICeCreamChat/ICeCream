# Smart Seating Planner - å®æ–½è®¡åˆ’ v2

## æ ¸å¿ƒæ¶æ„: è§£æ â†’ ç¡®è®¤ â†’ æ‰§è¡Œ

```mermaid
flowchart LR
    A[ğŸŸ¢ æ™ºèƒ½è§£æ] --> B[ğŸŸ¡ å¯è§†åŒ–åšå¼ˆ]
    B --> C[ğŸ”´ æ’åº§è®¡ç®—]
    C --> D[ğŸ“¤ å¯¼å‡ºåˆ†äº«]
```

---

## ğŸ”’ å…³é”®æ”¹è¿›ç‚¹

### 1. AI æ•°æ®ä¸€è‡´æ€§æ ¡éªŒ (Critical)
```javascript
// åç«¯å¿…é¡»æ ¡éªŒ
const inputIds = students.map(s => s.id).sort();
const outputIds = layout.flat().filter(id => id).sort();
if (JSON.stringify(inputIds) !== JSON.stringify(outputIds)) {
    throw new Error("AI ç»“æœä¸ä¸€è‡´ï¼Œè‡ªåŠ¨é‡è¯•...");
}
```

### 2. çœŸå®æ•™å®¤å¸ƒå±€æ”¯æŒ
- **è¿‡é“æ ‡è®°**: Grid ä¸­æ”¯æŒ `_aisle_` å ä½ç¬¦
- **ç©ºåº§å¤„ç†**: å¥‡æ•°äººæ•°æ—¶ç”¨ `null` å¡«å……
- **å³é”®èœå•**: è®¾ä¸ºè¿‡é“/ç©ºåº§

### 3. æ™ºèƒ½åå•å¯¼å…¥
- **Excel ç²˜è´´è§£æ**: `å¼ ä¸‰\tç”·\t85` â†’ è‡ªåŠ¨è¯†åˆ«åˆ—
- **é¢„è§ˆç¡®è®¤**: "è¯†åˆ«åˆ° 45 äººï¼Œè¯·ç¡®è®¤æ ¼å¼"

### 4. å¯¼å‡ºåŠŸèƒ½
- **PNG å›¾ç‰‡**: `html2canvas` æˆªå›¾ â†’ å‘ç­çº§ç¾¤
- **Excel æ–‡ä»¶**: çº¯æ–‡æœ¬åº§ä½è¡¨ â†’ æ•™åŠ¡å­˜æ¡£

### 5. çº¦æŸçŠ¶æ€å¯è§†åŒ–
- âœ… æ»¡è¶³ â†’ æ­£å¸¸å›¾æ ‡
- âš ï¸ æœªæ»¡è¶³ç¡¬çº¦æŸ â†’ çº¢è‰²é—ªçƒ
- ğŸ’” æœªæ»¡è¶³è½¯çº¦æŸ â†’ ç°è‰²ç©ºå¿ƒ

---

## æ•°æ®æ¨¡å‹

```typescript
interface Student {
  id: string; name: string; gender: 'M'|'F';
  grade?: number; visionIssue?: boolean; height?: number;
}

interface Constraint {
  type: 'front_row'|'avoid'|'prefer'|'pair';
  target: string; related?: string;
  reason: string; priority: 'hard'|'soft';
}

interface ClassroomGrid {
  rows: number; cols: number;
  aisles: number[]; // è¿‡é“åˆ—ç´¢å¼•
  layout: (string|null)[][]; // studentId æˆ– null
}
```

---

## AI Prompt (ä¼˜åŒ–ç‰ˆ)

```markdown
ä½ æ˜¯åº§ä½è§„åˆ’ç®—æ³•ä¸“å®¶ã€‚

ã€ä»»åŠ¡ã€‘å°† {{count}} åå­¦ç”Ÿå¡«å…¥ {{rows}}Ã—{{cols}} ç½‘æ ¼ã€‚

ã€è§„åˆ™ã€‘
1. å®Œæ•´æ€§: è¾“å‡ºå¿…é¡»æ°å¥½åŒ…å«æ‰€æœ‰å­¦ç”ŸID
2. ç©ºåº§: ä½ç½®å¤šäºå­¦ç”Ÿæ—¶ç”¨ null å¡«å……
3. ä¼˜å…ˆçº§: ç¡¬çº¦æŸ > é¿å«Œ > ç­–ç•¥ > å¿ƒæ„¿

ã€è¾“å‡º JSONã€‘
{
  "layout": [["s01","s02",null],["s03","s04","s05"]],
  "stats": {"total":45, "gender_mix":0.85},
  "unsatisfied": [{"target":"s05","reason":"å‰æ’å·²æ»¡"}]
}
```

---

## å‰ç«¯å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸª‘ æ™ºèƒ½åº§ä½å®‰æ’                    [â† è¿”å›] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“ å­¦ç”Ÿåå•   â”‚ ğŸ« æ•™å®¤è§†å›¾ (æ”¯æŒè¿‡é“)     â”‚
â”‚ [ç²˜è´´/å¯¼å…¥]   â”‚ â”Œâ”€â”€â”¬â”€â”€â”¬ â”¬â”€â”€â”¬â”€â”€â”            â”‚
â”‚ [é¢„è§ˆç¡®è®¤]    â”‚ â”‚ğŸ‘“â”‚ğŸ’™â”‚ â”‚  â”‚  â”‚ (ç©ºæ ¼=è¿‡é“) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â””â”€â”€â”´â”€â”€â”´ â”´â”€â”€â”´â”€â”€â”˜            â”‚
â”‚ ğŸ“£ çº¦æŸæè¿°   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [è§£æçº¦æŸ]    â”‚ ğŸ“Š çº¦æŸçŠ¶æ€                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ âœ… å¼ ä¸‰å‰æ’  âš ï¸ æå››å†²çª   â”‚
â”‚ âš™ï¸ ç­–ç•¥å¼€å…³   â”‚ ğŸ’” èµµå…­å¿ƒæ„¿æœªæ»¡è¶³          â”‚
â”‚ â˜‘ ç”·å¥³æ­é…   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â˜‘ å¼ºå¼±äº’è¡¥   [ğŸ¯ç”Ÿæˆ] [ğŸ“¸å¯¼å‡ºPNG] [ğŸ“Šå¯¼å‡ºExcel]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `seating-planner.js` | å‰ç«¯ä¸»æ¨¡å— |
| `seating-planner.css` | ä¸“ç”¨æ ·å¼ |
| `tools.js` | åç«¯ API (parse/plan) |
